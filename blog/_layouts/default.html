<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>

    <!-- Styles -->
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/syntax.css' | relative_url }}">

    <!-- KaTeX for math rendering (lightweight) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
            onload="renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                    {left: '\\[', right: '\\]', display: true},
                    {left: '\\(', right: '\\)', display: false}
                ]
            });"></script>

    <!-- WGo.js for interactive Go boards -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/wgo@2.3.1/wgo.player.css">
    <script defer src="https://cdn.jsdelivr.net/npm/wgo@2.3.1/wgo.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/wgo@2.3.1/wgo.player.min.js"></script>

    <!-- Open Graph -->
    <meta property="og:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}">
    <meta property="og:description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">
    <meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
    <meta property="og:url" content="{{ page.url | absolute_url }}">
    {% if page.og_image %}
    <meta property="og:image" content="{{ page.og_image | absolute_url }}">
    {% else %}
    <meta property="og:image" content="{{ '/assets/og/main.png' | absolute_url }}">
    {% endif %}

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
</head>
<body>
    <!-- Theme toggle - 陰陽 (in'yō) -->
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme" title="陰陽">
        <span class="sun">☀</span>
        <span class="moon">☾</span>
    </button>

    <div class="container">
        <header>
            <a href="{{ '/' | relative_url }}" class="home-link">{{ site.title }}</a>
        </header>

        <main>
            {{ content }}
        </main>

        <footer>
            <div class="quote">
                碁は対話<br>
                <em>Go is conversation</em>
            </div>
            <p class="attribution">
                下手の考え休むに似たり — <em>A weak player's thinking resembles resting</em><br>
                <a href="https://me.nech.pl">PLN</a> · <a href="{{ '/glossary' | relative_url }}">Glossary</a> · <a href="https://github.com/plnech/gogogo">Free Software</a>
            </p>
        </footer>
    </div>
    <script>
    // Theme toggle - respects system preference but allows override
    function getTheme() {
        const stored = localStorage.getItem('theme');
        if (stored) return stored;
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }

    function setTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
    }

    function toggleTheme() {
        const current = getTheme();
        setTheme(current === 'dark' ? 'light' : 'dark');
    }

    // Apply on load
    setTheme(getTheme());
    </script>
</body>
</html>
